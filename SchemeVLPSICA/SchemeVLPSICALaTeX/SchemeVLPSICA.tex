\documentclass[a4paper]{article}
\setlength{\parindent}{0pt}
\usepackage{amsmath,amssymb}
\usepackage{bm}

\begin{document}

\section{SchemeVLPSICA}

\subsection{$\textbf{Setup}(m, n, d) \rightarrow (\textit{mpk}, \textit{msk})$}

$g_1 \gets 1_{\mathbb{G}_1}$

$g_2 \gets 1_{\mathbb{G}_2}$

generate $s \in \mathbb{Z}_p^*$ randomly

$\vec{S} \gets (S_0, S_1, \cdots, S_{m + d}) = (g_2^{s_0}, g_2^{s_1}, \cdots, g_2^{s^{m + d}})$

$S' \gets g_1^s \in \mathbb{G}_1$

$H: \mathbb{G}_T \rightarrow \{0, 1\}^\lambda$

$\textit{mpk} \gets (g_1, S', H)$

$\textit{msk} \gets (g_2, \vec{S})$

\textbf{return} $(\textit{mpk}, \textit{msk})$

\subsection{$\textbf{Sender}(\vec{v}, \vec{Y}) \rightarrow (\vec{T} || \vec{T}', \vec{U} || \vec{U}')$}

generate $k \in \mathbb{N}* \cap [0, n)$ randomly

$\pi: x \rightarrow (x + k) \% n$

generate $\vec{t} \gets (t_1, t_2, \cdots, t_n) \in \mathbb{Z}_r^n$ randomly

$\vec{T} \gets (T_1, T_2, \cdots, T_n) = (g_1^{t_1}, g_1^{t_2}, \cdots, g_1^{t_n})$

$\vec{U} \gets (U_1, U_2, \cdots, U_n) = (S' \cdot (g_1^{-y_{\pi(1)}}), S' \cdot (g_1^{-y_{\pi(2)}}), \cdots, S' \cdot (g_1^{-y_{\pi(n)}}))$

generate $\vec{t}' = (t'_1, t'_2, \cdots, t'_d) \in \mathbb{Z}_r^d$ randomly

$\vec{T}' \gets (T'_1, T'_2, \cdots, T'_d) = (g_1^{t'_1}, g_1^{t'_2}, \cdots, g_1^{t'_d})$

$\vec{U}' \gets (U'_1, U'_2, \cdots, U'_d) = (S' \cdot (g_1^{-v_1})^{t'_1}, S' \cdot (g_1^{-v_2})^{t'_2}, \cdots, S' \cdot (g_1^{-v_d})^{t'_d})$

\textbf{return} $(\vec{T} || \vec{T}', \vec{U} || \vec{U}')$

\subsection{$\textbf{Receiver}(\vec{v}, \vec{X}) \rightarrow (R, \vec{R}')$}

$\vec{X}' \gets (\vec{X} || \vec{v}) \in \mathbb{Z}_r^{m + d}$

generate $r \in \mathbb{Z}_r$ randomly

$R \gets \left(\prod\limits_{j = 0}^{m + d} S_j^{p(X', j)}\right)^r$

$R_{-i} \gets \left(\prod\limits_{j = 0}^{m + d - 1} S_j^{p(X'_{-i}, j)}\right)^r, \forall i \in {1, 2, \cdots, m + d}$

\textbf{return} $(R, \vec{R}')$

\subsection{$\textbf{Cloud1}((\vec{T}, \vec{T}'), R) \rightarrow \vec{W}$}

$W_j \gets H(e((\vec{T} || \vec{T}')_j, R)), \forall j \in {1, 2, \cdots, n + d}$

generate $k_1 \in \mathbb{N}* \cap [0, n + d)$ randomly

$\pi_1: x \rightarrow (x + k_1) \% (n + d)$

$\vec{W} \gets \{\vec{W}_{\pi_1(j)}\}_j$

\textbf{return} $\vec{W}$

\subsection{$\textbf{Cloud2}(\vec{U}, R') \rightarrow \vec{K}$}

$\vec{K}_{i(n + d) + j} \gets H(e((\vec{U} || \vec{U}')_j, R'_i)), \forall i \in {1, 2, \cdots, m + d}, \forall j \in {1, 2, \cdots, n + d}$

generate $k_2 \in \mathbb{N}* \cap [0, (m + d)(n + d))$ randomly

$\pi_2: i, j \rightarrow (i(n + d) + j + k_2) \% (m + d)(n + d)$

$\vec{K} \gets \{\vec{K}_{\pi_2(i, j)}\}_{i, j}$

\textbf{return} $\vec{K}$

\subsection{$\textbf{Verify}(\vec{K}, \vec{W}) \rightarrow \textit{result}$}

\textbf{if} $\vec{W} \subseteq \vec{K}$ \textbf{then}

	\quad$\textit{result} \gets |\vec{K} \cap \vec{W}| - d = |\vec{W}| - d = n + d - d = n$

\textbf{else}

	\quad$\textit{result} \gets \perp$

\textbf{end if}

\textbf{return} $\textit{result}$

\end{document}